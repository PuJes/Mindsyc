# 1. 需求背景
> 传统 PRD 的基本板块。

## 1.1 问题描述
用户在进行深度研究时面临以下痛点：
1. **信息碎片化**：需要同时查阅多个搜索引擎、网站、文档才能获得全面信息  
2. **研究效率低**：手动收集、整理、分析信息耗时耗力，一个深度研究课题可能需要数小时甚至数天  
3. **信息质量参差**：难以快速识别和筛选高质量、可信度高的信息源  
4. **缺乏系统性**：缺少结构化的研究方法和指引，容易遗漏重要维度  
5. **多任务切换困难**：需要在搜索、阅读、代码执行、记录等多个工具间频繁切换

## 1.2 目标用户
- **研究人员**：需要快速完成文献综述、市场调研、技术分析  
- **投资分析师**：需要跟踪了解行业动态、技术趋势、公司情况  
- **产品经理**：需要进行竞品分析、用户研究、市场趋势分析  
- **内容创作者**：需要为文章、视频收集素材和数据支撑  
- **学生群体**：需要完成课题研究、论文资料收集

## 1.3 业务目标
**核心目标**：将原本需要数小时的深度研究工作压缩到 **15–30 分钟** 内完成，且质量不降低。  
**量化指标：**
- **研究效率提升**：单次深度研究的平均用时由 **≈4h** 缩短至 **≤30min**  
- **信息覆盖度**：单次研究涉及的信息源数量从 **5–8 个** 提升到 **20+ 个**  
- **用户满意度**：生成报告的有用性评分 **≥ 4.0/5.0**  
- **用户留存**：**7 日留存率 ≥ 40%**

---

# 2. 产品定位
> 传统 PRD 的基本板块。

## 2.1 产品定义
**DeerFlow** 是一款基于大语言模型的智能深度研究助手，通过多 Agent 协作系统，自动化完成“**需求理解 → 计划制定 → 信息收集 → 分析整理 → 报告生成**”的完整研究流程。

## 2.2 核心价值
1. **自动化研究流程**：用户只需提出研究主题，系统自动完成全流程  
2. **多维度信息整合**：整合网络搜索、网页爬取、私域知识库、代码执行等多种信息源  
3. **专业报告输出**：生成结构化、引用规范的专业研究报告  
4. **人机协作模式**：关键节点支持人工介入审核和调整

## 2.3 产品差异化
| 对比维度 | 传统搜索引擎 | AI 问答助手 | **DeerFlow** |
|---|---|---|---|
| **信息深度** | 浅层碎片信息 | 单轮问答，缺乏系统性 | **多步骤深度挖掘** |
| **信息整合** | 需用户手动整理 | 简单汇总 | **结构化报告输出** |
| **研究计划** | 无 | 无 | **自动生成可调整的研究计划** |
| **信息来源** | 单一网络搜索 | 训练数据 + 简单搜索 | **网络 + 爬虫 + 代码 + 知识库** |
| **人工控制** | 全人工 | 无法干预 | **关键节点可人工审核** |

## 2.4 大模型优势
| 传统方案局限性 | 大模型优势 |
|---|---|
| **（任务理解与产出）** | **（任务理解与产出）** |
| 基于关键词匹配，缺乏语义理解 | 深度理解用户意图，支持自然语言交互 |
| 信息整合依赖人工、效率低 | 智能信息筛选与相关性判断 |
| 报告生成需要专业写作技能 | 自动生成结构化专业报告 |
| 语言/语境能力有限 | 支持多语言与不同语境研究 |
| **（信息处理与推理）** | **（信息处理与推理）** |
| 缺乏上下文关联 | 长上下文窗口，保持信息连贯 |
| 复杂逻辑推理困难 | 复杂逻辑与因果关系分析 |
| 跨知识点联动弱 | 跨领域知识整合与联动分析 |
| 容易噪声与错误 | 智能消噪与纠错，理解真实需求 |
| **（自动化与多步协作）** | **（自动化与多步协作）** |
| 单一工具能力受限 | 多智能体分解与规划 |
| 复杂任务难自动化 | 多角色协作与资源调度 |
| 缺少协同机制 | 自适应流程与动态优化 |
| **（个性化与场景适应）** | **（个性化与场景适应）** |
| 固定模板/流程 | 学习用户偏好并个性化 |
| 个性化能力不足 | 个性化研究策略推荐 |
| 难以根据反馈优化 | 动态调整研究深度/广度 |
| **（多模态内容生成）** | **（多模态内容生成）** |
| 单一文本输出 | 支持文本/图像/音频等多模态 |
| 创意不足、风格单一 | 创意生成与风格化处理 |
| 生产成本高 | 批量化生产、成本下降；跨模态一致性保证 |

---

# 3. 用户故事
> 基于 DeerFlow 定位与功能形态推演得到的细分用户场景。

## 3.1 研究人员的深度调研需求
**用户故事**  
> 作为 **一名研究人员**，  
> 我希望 **能够快速获得某个技术领域的全面分析报告**，  
> 以便于 **我能迅速理解该领域的现状、主要技术、应用场景与未来趋势**。

**验收标准**
- 系统能理解研究需求（如“分析量子计算对密码学的影响”）  
- 自动集合多个权威来源（论文、技术报告、新闻等）  
- 生成结构化分析报告（概述、详细分析、关键发现等）

---

## 3.2 内容创作者的多平台内容需求
**用户故事**  
> 作为 **一名内容创作者**，  
> 我希望 **基于热点话题快速生成多种格式的内容**，  
> 以便于 **我能在多个平台产出不同类型的内容，提高创作效率**。

**验收标准**
- 输入话题后生成 **文本大纲**  
- 基于报告内容 **自动生成播客脚本**  
- 支持 **文本转语音** 生成音频  
- 能 **自动生成 PPT 演示稿** 用于视频制作

**技术实现**
- 基础研究报告生成  
- 播客/短视频脚本生成器  
- TTS 服务生成音频文件  
- PPT 生成器创建演示文稿

---

## 3.3 企业分析师的市场调研需求
**用户故事**  
> 作为 **一名企业分析师**，  
> 我希望 **快速了解竞争对手动向与市场趋势**，  
> 以便于 **为公司决策提供及时的市场洞察**。

**验收标准**
- 搜索引擎聚合，保证权威性  
- 整合企业内知识与外部公开信息  
- 生成企业市场分析报告（含细分领域/竞对对比）  
- 结构化图表输出与专业报告格式  
- 支持品牌化定制

**技术实现**
- 搜索引擎配置与检索过滤  
- **RAG** 集成（私有知识库）  
- 任务中枢（计划/执行）  
- 报告编辑器（布局/样式优化）

---

## 3.4 学生的学术研究需求
**用户故事**  
> 作为 **一名学生**，  
> 我希望 **获得某学术话题的系统性分析**，  
> 以便于 **理解核心概念、发展历程与研究现状**。

**验收标准**
- 支持 **多轮澄清**，理解具体需求  
- 支持 **学术论文检索** 与 **专业问答**  
- 生成 **结构化学术研究报告**  
- **交互式学习**，能分步回答

**技术实现**
- 智能澄清链/澄清树  
- **Arxiv** 源接入  
- 学术友好格式模板  
- 章节式对话助手

---

## 3.5 咨询顾问的客户报告需求
**用户故事**  
> 作为 **一名咨询顾问**，  
> 我希望 **能够快速为客户生成专业的行业分析报告**，  
> 以便于 **提升效率并向客户提供更有价值的服务**。

**验收标准**
- 自定义研究深度与报告格式  
- 整合多数据源，确保全面性  
- 生成符合咨询行业标准的专业报告  
- 支持图表化输出、企业内外知识整合  
- 支持品牌化与模板化能力

---

# 4. 模型故事
> 针对各 Agent 的“模型故事”（Model Story），用于明确其所需的上下文、能力与工具。

在传统 PRD 中用“**用户故事**”表达：  
- **作为**（用户角色） / **在**（场景） / **为了**（目标） / **需要**（功能）

在本 PRD 中用“**模型故事**”表达 **Agent 需求**：  
- **作为**（Agent 角色） / **在**（任务场景） / **为了**（目标） / **需要**（上下文/工具/能力）

## 4.1 Coordinator Agent 模型故事

### 模型故事 1：识别用户意图
**场景描述**：当用户发送第一条消息时，需要快速判断是**简单对话/不当请求/研究请求**。  
**模型故事（Plain Text）**
```

1  作为 Coordinator Agent
2  在 接收到用户首次消息时
3  为了 正确分类并采取对应行动（直接回复/拒绝/移交）
4  我需要：
5  [上下文信息]
6  - 用户的原始输入文本
7  - 当前对话的语言 locale（如果能检测到）
8  - 系统当前时间
9
10 [能力支持]
11 - 多语言理解能力（支持中英等主流语言）
12 - 意图分类能力（三分类：闲聊 / 不当 / 研究）
13 - 工具调度能力（能主动调用 handoff_to_planner 工具）
14
15 [工具清单]
16 1. handoff_to_planner(research_topic, locale)
17    - 用途：将研究类请求移交给 planner
18    - 何时使用：识别到研究类请求时
19
20 [约束条件]
21 - 不能尝试直接回答研究问题
22 - 对于研究请求必须调用工具，不能文本回复
23 - 需要在 3 秒内完成意图识别

```
**为什么需要这些**：  
- 无历史对话需仅依赖输入文本；  
- 快速决策，不做深思；  
- 通过工具绑定防止自由发挥。

---

### 模型故事 2：引导澄清对话
**场景描述**：当用户提出**模糊研究主题**（如“研究 AI”“分析市场”）时，需要通过**多轮对话**获取**明确维度**。  
**模型故事（Plain Text）**
```
1  作为 Coordinator Agent
2  在 检测到用户研究主题不明确时
3  为了 通过最多 3 轮对话获取 2+ 个明确维度
4  我需要：
5  [上下文信息]
6  - 用户的原始模糊主题
7  - 已进行的澄清轮次数 (clarification_rounds)
8  - 历史澄清对话记录 (clarification_history)
9  - 最大澄清轮次限制 (max_clarification_rounds)
10 - 可识别的维度（从历史中提取）
11
12 [能力支持]
13 - 澄清需求判断能力（判断是否需要澄清）
14 - 维度推荐能力（技术/领域/角度/范围等）
15 - 问题生成能力（生成有效的澄清问题）
16 - 防重复能力（不重复已问过的维度）
17
18 [工具清单]
19 1. handoff_after_clarification(locale)
20    - 用途：澄清完成后移交 planner
21    - 何时使用：已获得 2+ 维度或达到最大轮次时
22
23 [约束条件]
24 - 每次只问 1 个问题，并明确对应维度
25 - 必须给出 3–5 个具体示例选项
26 - 不使用过于开放的问题
27 - 第 3 轮后必须决定是否进入下一步
```
**为什么需要这些**：  
- 渐进式信息收集，降低用户负担；  
- 轮次与退出机制避免“无限追问”；  
- 维度互补，保证覆盖面。

---

### 模型故事 3：处理澄清回复
**场景描述**：在澄清过程中，用户给出回复时，需要**判断是否已足够**，决定**继续澄清或移交**。  
**模型故事（Plain Text）**
```
1  作为 Coordinator Agent
2  在 收到用户对澄清问题的回复时
3  为了 决定是继续澄清还是移交给 planner
4  我需要：
5  [上下文信息]
6  - 原始模糊主题
7  - 所有历史澄清问答（包含本轮）
8  - 当前轮次 (clarification_rounds)
9  - 从历史中提取的明确定义/维度列表
10
11 [能力支持]
12 - 信息提取能力（从用户回复中提取关键信息）
13 - 维度评估能力（判断已获得几个维度）
14 - 充分性判断能力（判断维度是否达成）
15
16 [决策规则]
17 - 0–1 个维度：继续问（生成新问题）
18 - 2+ 个维度：调用 handoff_after_clarification
19 - 达到最大轮次：强制调用 handoff_after_clarification
20
21 [约束条件]
22 - 必须准确统计维度数量
23 - 不能因为用户回复很详细就判定“已充分”
24 - 必须遵守节奏限制
```
**为什么需要这些**：  
- 客观基于**规则**而非主观感觉；  
- 防止**过早移交**或**过度澄清**。


